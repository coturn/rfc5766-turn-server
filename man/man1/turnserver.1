.\" Text automatically generated by txt2man
.TH TURN  "31 December 2012" "" ""
.SH GENERAL INFORMATION

The \fBTURN Server\fP project contains the source code of a TURN server and TURN client 
messaging library. Also, four extra programs provided, for testing-only 
purposes. 
.PP
See the INSTALL file for the building instructions.
.PP
After the build, you will have the following binary images:
.TP
.B
1.
\fIturnserver\fP: \fBTURN Server\fP relay. 
The compiled binary image of this program is located in bin/ sub-directory.
.TP
.B
2.
\fIturnadmin\fP: TURN administration tool. This tool can be used to generate 
TURN keys for the user accounts. For security reasons, we do not recommend 
storing passwords openly. The better option is to use pre-processed "keys" 
which are then used for authentication. These keys are generated by \fIturnadmin\fP. 
Turnadmin is a link to \fIturnserver\fP binary, but \fIturnadmin\fP performs different 
functions.
.TP
.B
3.
\fIuclient\fP: emulates multiple UDP,TCP,TLS or DTLS clients. 
(this program is provided for the testing purposes only !)
The compiled binary image of this program is located in turn.apps.examples/bin/ 
sub-directory.
.PP
WARNING: the \fIuclient\fP program is a primitive client application. 
It does not implement the re-transmission pattern that is necessary for 
a correct TURN client implementation. In TURN, the retransmission burden 
is lying entirely on the client application. We provide the messaging 
functionality in the client library, but the client must implement 
the correct Networking IO processing in the client program code.
.TP
.B
4.
\fIpeer\fP: a simple stateless UDP-only "echo" server, 
to be used as the final server in relay pattern ("\fIpeer\fP"). For every incoming 
UDP packet, it simply echoes it back.
(this program is provided for the testing purposes only !) 
When the test clients are communicating in the client-to-client manner, 
this component is not needed.
.PP
The compiled binary image of this program is located in turn.apps.examples/bin/ subdirectory.
.TP
.B
5.
\fIstunclient\fP: a simple STUN client example.
The compiled binary image of this program is located in turn.apps.examples/bin/ subdirectory.
.PP
In the "scripts" subdirectory, you will find the examples of command lines to be used 
to run the programs.
.SH RUN

.TP
.B
1.
\fIturnserver\fP application is a TURN relay server implementation. 
.PP
Usage:
.PP
$ \fIturnserver\fP [\fB-vfa\fP] [\fB-n\fP | \fB-c\fP <config-file> ] [\fB-b\fP <user-db-file> | \fB--userdb\fP=<user-db-file> ] [options]
.PP
$ \fIturnserver\fP \fB-h\fP
.TP
.B
Flags:
.TP
.B
\fB-v\fP, \fB--verbose\fP
Verbose.
.TP
.B
\fB-f\fP, \fB--fingerprint\fP
Use fingerprints in the TURN messages.
.TP
.B
\fB-a\fP, \fB--lt-cred-mech\fP
Use long-term credential mechanism. 
By default, no credential mechanism is used -
any user is allowed.
.TP
.B
Config file setting:
.TP
.B
\fB-n\fP
Do not use configuration file, use only command line parameters.
.TP
.B
\fB-c\fP
Configuration file name (default - turnserver.conf).
The format of config file can be seen in
the supplied etc/turnserver.conf example file. Long 
names of the options are used as the configuration 
items names in the file. If not an absolute path is supplied, 
then the file is searched in the following directories: 
.RS
.IP \(bu 3
current directory
.IP \(bu 3
current directory etc/ subdirectory
.IP \(bu 3
upper directory level etc/
.IP \(bu 3
/etc/
.IP \(bu 3
/usr/local/etc/
.RE
.TP
.B
\fB-b\fP, \fB--userdb\fP
\(cqDynamic' user database file name (default - turnuserdb.conf).
This user database is being dynamically checked while the \fIturnserver\fP 
is working, and the user accounts can be changed dynamically by
editing the file.
.TP
.B
Options:
.TP
.B
\fB-d\fP, \fB--listening-device\fP
Listener interface device (optional functionality, Linux only).
.TP
.B
\fB-p\fP, \fB--listening-port\fP
TURN listener port for UDP and TCP listeners (Default: 3478).
.TP
.B
\fB--tls-listening-port\fP
TURN listener port for TLS and DTLS listeners (Default: 5349).
.TP
.B
\fB-L\fP, \fB--listening-ip\fP
Listener IP address of relay server. 
Multiple listeners can be specified.
If no \fBIP\fP(s) specified, then all IPv4 and 
IPv6 system IPs will be used for listening.
.TP
.B
\fB-i\fP, \fB--relay-device\fP
Relay interface device for relay sockets 
(optional, Linux only).
.TP
.B
\fB-E\fP, \fB--relay-ip\fP
Relay address (the local IP address that 
will be used to relay the packets to the 
\fIpeer\fP). Multiple relay addresses may be used.
If no relay \fBIP\fP(s) specified, then all 
non-loopback system IPs will be used.
.TP
.B
\fB-m\fP, \fB--relay-threads\fP
number of extra threads to handle the 
established connections.
By default, everything in handled in single thread 
(the default number of extra threads is 0).
.TP
.B
\fB--min-port\fP
Lower bound of the UDP port range for relay 
endpoints allocation.
Default value is 49152, according to RFC 5766.
.TP
.B
\fB--max-port\fP
Upper bound of the UDP port range for relay 
endpoints allocation.
Default value is 65535, according to RFC 5766.
.TP
.B
\fB-u\fP, \fB--user\fP
User account, in the column-separated 
form 'username:key'. 
The key is either the user password, or
the key is generated
by \fIturnadmin\fP command. In the second case,
the key must be prepended with '0x' symbols.
The key is calculated over the user name, 
the realm, and the user password.
.TP
.B
\fB-r\fP, \fB--realm\fP
Realm to be used for all users.
.TP
.B
\fB-q\fP, \fB--user-quota\fP
Per-user allocation quota.
.TP
.B
\fB-Q\fP, \fB--total-quota\fP
total allocation quota.
.TP
.B
\fB--cert\fP
Certificate file, PEM format. Same file 
search rules applied as for the configuration 
file. If both \fB--no-tls\fP and \fB--no-dtls\fP options 
are specified, 
then this parameter is not needed.
.TP
.B
\fB--pkey\fP
Private key file, PEM format. Same file 
search rules applied as for the configuration 
file. If both \fB--no-tls\fP and \fB--no-dtls\fP options 
are specified, then this parameter is not needed.
.TP
.B
\fB--no-udp\fP
Do not start UDP listeners.
.TP
.B
\fB--no-tcp\fP
Do not start TCP listeners.
.TP
.B
\fB--no-tls\fP
Do not start TLS listeners.
.TP
.B
\fB--no-dtls\fP
Do not start DTLS listeners.
.TP
.B
\fB-h\fP
Help.
.TP
.B
2.
\fIturnadmin\fP application is a TURN relay administration tool. 
.TP
.B
Usage:
.PP
$ \fIturnadmin\fP [command] [options]
.PP
$ \fIturnadmin\fP [ \fB-h\fP | \fB--help\fP]
.TP
.B
Commands:
.TP
.B
\fB-k\fP, \fB--key\fP
Generate key for a user.
.TP
.B
\fB-a\fP, \fB--add\fP
Add or update a user.
.TP
.B
\fB-d\fP, \fB--delete\fP
Delete a user.
.TP
.B
Options:
.TP
.B
\fB-b\fP, \fB--userdb\fP
\(cqDynamic' user database file name (default - turnuserdb.conf).
.TP
.B
\fB-u\fP, \fB--user\fP
User name.
.TP
.B
\fB-r\fP, \fB--realm\fP
Realm.
.TP
.B
\fB-p\fP, \fB--password\fP
Password.
.TP
.B
\fB-h\fP, \fB--help\fP
Help.
.TP
.B
Generate a key:
.PP
$ \fIturnadmin\fP \fB-k\fP \fB-u\fP <username> \fB-r\fP <realm> \fB-p\fP <password>
.TP
.B
Add/update a user (and realm) in the userdb file:
.PP
$ \fIturnadmin\fP \fB-a\fP [\fB-b\fP <user-db-file>] \fB-u\fP <username> \fB-r\fP <realm> \fB-p\fP <password>
.TP
.B
Delete a user from the userdb file:
.PP
$ \fIturnadmin\fP \fB-d\fP [\fB-c\fP <user-db-file>] \fB-u\fP <username>
.TP
.B
Help:
.PP
$ \fIturnadmin\fP \fB-h\fP
.TP
.B
3.
\fIuclient\fP application is for test purposes only. 
It was designed to simulate multiple clients. It uses asynch IO API in 
libevent to handle multiple clients. A client connects to the relay, 
negotiates the session, and sends multiple (configured number) messages to the server (relay), 
expecting the same number of replies. The length of the messages is configurable. 
The message is an arbitrary octet stream, but it can be configured as a string. 
The number of the messages to send is configurable. 
.TP
.B
Usage:
.PP
$ \fIuclient\fP [\fB-tSvsyhcxg\fP] [options] <TURN-Server-IP-address>
.TP
.B
Flags:
.TP
.B
\fB-t\fP
Use TCP (default is UDP).
.TP
.B
\fB-S\fP
Secure connection: TLS for TCP, DTLS for UDP.
.TP
.B
\fB-v\fP
Verbose.
.TP
.B
\fB-s\fP
Use "send" method in TURN; by default, it uses TURN "channels".
.TP
.B
\fB-y\fP
Use client-to-client connections: 
RTP/RTCP pair of channels to another RTP/RTCP pair of channels.
with this option the \fIpeer\fP application is not used,
as the relay endpoints are talking to each other. 
.TP
.B
\fB-h\fP
Hang on indefinitely after the last sent packet.
.TP
.B
\fB-c\fP
Do not create rtcp connections.
.TP
.B
\fB-x\fP
Request IPv6 relayed address (RFC6156).
.TP
.B
\fB-g\fP
Set DONT_FRAGMENT parameter in TURN requests.
.TP
.B
Options:
.TP
.B
\fB-l\fP
Message length (Default: 100 Bytes).
.TP
.B
\fB-i\fP
Certificate file (for secure connections only).
.TP
.B
\fB-k\fP
Private key file (for secure connections only).
.TP
.B
\fB-p\fP
\fBTURN Server\fP port (Default: 3478 unsecure, 5349 secure).
.TP
.B
\fB-n\fP
Number of messages to send (Default: 5).
.TP
.B
\fB-d\fP
Local interface device (optional).
.TP
.B
\fB-L\fP
Local IP address (optional).
.TP
.B
\fB-m\fP
Number of clients (default is 1, 2 or 4, depending on options below).
.TP
.B
\fB-e\fP
Peer address.
.TP
.B
\fB-r\fP
Peer port (default 3479).
.PP
See the examples in the "scripts" directory.
.TP
.B
4.
\fIpeer\fP application is a simple UDP-only echo backend server. This application
is used for the test purposes only, as a '\fIpeer\fP' for the \fIuclient\fP application. 
.TP
.B
Usage:
.PP
$ \fIpeer\fP [\fB-v\fP] [options]
.TP
.B
Options:
.TP
.B
\fB-p\fP
Listening UDP port (Default: 3479). 
.TP
.B
\fB-d\fP
Listening interface device (optional)
.TP
.B
\fB-L\fP
Listening address of \fIpeer\fP server
.TP
.B
\fB-v\fP
Verbose
.TP
.B
5.
\fIstunclient\fP is a basic STUN client. It sends a STUN request and shows the reply information.
.TP
.B
Usage:
.PP
$ \fIstunclient\fP [options] <STUN-Server-IP-address>
.TP
.B
Options:
.TP
.B
\fB-p\fP
STUN server port (Default: 3478). 
.TP
.B
\fB-L\fP
Local address to use (optional).
.SH LIBRARIES

In the lib/ sub-directory the build process will create TURN client messaging library.
In the include/ sub-directory, the necessary include files will be placed.
